const miscFilename = 'global\\excel\\misc.txt';
const misc = D2RMM.readTsv(miscFilename);

if (config?.fullPotionOnlyInHell) {

	misc.rows = misc.rows.filter((row) => row.name !== 'Rejuvenation Potion')

	misc.rows.push({
		name: 'Rejuvenation Potion',
		compactsave: 1,
		version: 100,
		level: 0,
		ShowLevel: 0,
		levelreq: 0,
		reqstr: null,
		reqdex: null,
		rarity: 2,
		spawnable: 1,
		speed: 0,
		nodurability: 1,
		cost: config.sellPriceSmall,
		'gamble cost': null,
		code: 'rvs',
		alternategfx: 'yps',
		namestr: 'rvs',
		component: 16,
		invwidth: 1,
		invheight: 1,
		hasinv: 0,
		gemsockets: 0,
		gemapplytype: 0,
		flippyfile: 'flpvps',
		invfile: 'invvps',
		uniqueinvfile: null,
		Transmogrify: 0,
		TMogType: 'xxx',
		TMogMin: null,
		TMogMax: null,
		useable: 1,
		type: 'rpot',
		type2: null,
		dropsound: 'item_potion',
		dropsfxframe: 14,
		usesound: 'item_potion_drink',
		unique: 0,
		transparent: 0,
		transtbl: 5,
		lightradius: 0,
		belt: 1,
		autobelt: 1,
		stackable: 0,
		minstack: 0,
		maxstack: 0,
		spawnstack: 0,
		quest: null,
		questdiffcheck: null,
		missiletype: 0,
		spellicon: -1,
		pSpell: 5,
		state: null,
		cstate1: null,
		cstate2: null,
		len: null,
		stat1: 'hitpoints',
		calc1: 35,
		stat2: 'mana',
		calc2: 35,
		stat3: null,
		calc3: null,
		spelldesc: 4,
		spelldescstr: 'ItemStatsrejuv1',
		spelldescstr2: 0,
		spelldesccalc: 35,
		spelldesccolor: null,
		durwarning: 0,
		qntwarning: 0,
		gemoffset: 0,
		BetterGem: 'non',
		bitfield1: 0,
		CharsiMin: 0,
		CharsiMax: 0,
		CharsiMagicMin: null,
		CharsiMagicMax: null,
		CharsiMagicLvl: 255,
		GheedMin: 0,
		GheedMax: 0,
		GheedMagicMin: null,
		GheedMagicMax: null,
		GheedMagicLvl: 255,
		AkaraMin: 1,
		AkaraMax: 1,
		AkaraMagicMin: null,
		AkaraMagicMax: null,
		AkaraMagicLvl: 255,
		FaraMin: 0,
		FaraMax: 0,
		FaraMagicMin: null,
		FaraMagicMax: null,
		FaraMagicLvl: 255,
		LysanderMin: 1,
		LysanderMax: 1,
		LysanderMagicMin: null,
		LysanderMagicMax: null,
		LysanderMagicLvl: 255,
		DrognanMin: 1,
		DrognanMax: 1,
		DrognanMagicMin: null,
		DrognanMagicMax: null,
		DrognanMagicLvl: 255,
		HratliMin: 0,
		HratliMax: 0,
		HratliMagicMin: null,
		HratliMagicMax: null,
		HratliMagicLvl: 255,
		AlkorMin: 0,
		AlkorMax: 0,
		AlkorMagicMin: null,
		AlkorMagicMax: null,
		AlkorMagicLvl: 255,
		OrmusMin: 1,
		OrmusMax: 1,
		OrmusMagicMin: null,
		OrmusMagicMax: null,
		OrmusMagicLvl: 255,
		ElzixMin: 0,
		ElzixMax: 0,
		ElzixMagicMin: null,
		ElzixMagicMax: null,
		ElzixMagicLvl: 255,
		AshearaMin: 0,
		AshearaMax: 0,
		AshearaMagicMin: null,
		AshearaMagicMax: null,
		AshearaMagicLvl: 255,
		CainMin: 0,
		CainMax: 0,
		CainMagicMin: null,
		CainMagicMax: null,
		CainMagicLvl: 255,
		HalbuMin: 0,
		HalbuMax: 0,
		HalbuMagicMin: null,
		HalbuMagicMax: null,
		HalbuMagicLvl: 255,
		MalahMin: 1,
		MalahMax: 1,
		MalahMagicMin: null,
		MalahMagicMax: null,
		MalahMagicLvl: 255,
		LarzukMin: 0,
		LarzukMax: 0,
		LarzukMagicMin: null,
		LarzukMagicMax: null,
		LarzukMagicLvl: 255,
		AnyaMin: 0,
		AnyaMax: 0,
		AnyaMagicMin: null,
		AnyaMagicMax: null,
		AnyaMagicLvl: 255,
		JamellaMin: 1,
		JamellaMax: 1,
		JamellaMagicMin: null,
		JamellaMagicMax: null,
		JamellaMagicLvl: 255,
		Transform: 0,
		InvTrans: 0,
		SkipName: 0,
		NightmareUpgrade: 'xxx',
		HellUpgrade: 'rvl',
		mindam: null,
		maxdam: null,
		PermStoreItem: 1,
		multibuy: 1,
		Nameable: null,
		diablocloneweight: null
	});
	misc.rows = misc.rows.filter((row) => row.name !== 'Full Rejuvenation Potion')

	misc.rows.push({
		name: 'Full Rejuvenation Potion',
		compactsave: 1,
		version: 100,
		level: 0,
		ShowLevel: 0,
		levelreq: 0,
		reqstr: null,
		reqdex: null,
		rarity: 2,
		spawnable: 1,
		speed: 0,
		nodurability: 1,
		cost: config.sellPriceFull,
		'gamble cost': null,
		code: 'rvl',
		alternategfx: 'ypl',
		namestr: 'rvl',
		component: 16,
		invwidth: 1,
		invheight: 1,
		hasinv: 0,
		gemsockets: 0,
		gemapplytype: 0,
		flippyfile: 'flpvpl',
		invfile: 'invvpl',
		uniqueinvfile: null,
		Transmogrify: 0,
		TMogType: 'xxx',
		TMogMin: null,
		TMogMax: null,
		useable: 1,
		type: 'rpot',
		type2: null,
		dropsound: 'item_potion',
		dropsfxframe: 14,
		usesound: 'item_potion_drink',
		unique: 0,
		transparent: 0,
		transtbl: 5,
		lightradius: 0,
		belt: 1,
		autobelt: 1,
		stackable: 0,
		minstack: 0,
		maxstack: 0,
		spawnstack: 0,
		quest: null,
		questdiffcheck: null,
		missiletype: 0,
		spellicon: -1,
		pSpell: 5,
		state: null,
		cstate1: null,
		cstate2: null,
		len: null,
		stat1: 'hitpoints',
		calc1: 100,
		stat2: 'mana',
		calc2: 100,
		stat3: null,
		calc3: null,
		spelldesc: 4,
		spelldescstr: 'ItemStatsrejuv1',
		spelldescstr2: 0,
		spelldesccalc: 100,
		spelldesccolor: null,
		durwarning: 0,
		qntwarning: 0,
		gemoffset: 0,
		BetterGem: 'non',
		bitfield1: 0,
		CharsiMin: 0,
		CharsiMax: 0,
		CharsiMagicMin: null,
		CharsiMagicMax: null,
		CharsiMagicLvl: 255,
		GheedMin: 0,
		GheedMax: 0,
		GheedMagicMin: null,
		GheedMagicMax: null,
		GheedMagicLvl: 255,
		AkaraMin: 0,
		AkaraMax: 0,
		AkaraMagicMin: null,
		AkaraMagicMax: null,
		AkaraMagicLvl: 255,
		FaraMin: 0,
		FaraMax: 0,
		FaraMagicMin: null,
		FaraMagicMax: null,
		FaraMagicLvl: 255,
		LysanderMin: 0,
		LysanderMax: 0,
		LysanderMagicMin: null,
		LysanderMagicMax: null,
		LysanderMagicLvl: 255,
		DrognanMin: 0,
		DrognanMax: 0,
		DrognanMagicMin: null,
		DrognanMagicMax: null,
		DrognanMagicLvl: 255,
		HratliMin: 0,
		HratliMax: 0,
		HratliMagicMin: null,
		HratliMagicMax: null,
		HratliMagicLvl: 255,
		AlkorMin: 0,
		AlkorMax: 0,
		AlkorMagicMin: null,
		AlkorMagicMax: null,
		AlkorMagicLvl: 255,
		OrmusMin: 0,
		OrmusMax: 0,
		OrmusMagicMin: null,
		OrmusMagicMax: null,
		OrmusMagicLvl: 255,
		ElzixMin: 0,
		ElzixMax: 0,
		ElzixMagicMin: null,
		ElzixMagicMax: null,
		ElzixMagicLvl: 255,
		AshearaMin: 0,
		AshearaMax: 0,
		AshearaMagicMin: null,
		AshearaMagicMax: null,
		AshearaMagicLvl: 255,
		CainMin: 0,
		CainMax: 0,
		CainMagicMin: null,
		CainMagicMax: null,
		CainMagicLvl: 255,
		HalbuMin: 0,
		HalbuMax: 0,
		HalbuMagicMin: null,
		HalbuMagicMax: null,
		HalbuMagicLvl: 255,
		MalahMin: 0,
		MalahMax: 0,
		MalahMagicMin: null,
		MalahMagicMax: null,
		MalahMagicLvl: 255,
		LarzukMin: 0,
		LarzukMax: 0,
		LarzukMagicMin: null,
		LarzukMagicMax: null,
		LarzukMagicLvl: 255,
		AnyaMin: 0,
		AnyaMax: 0,
		AnyaMagicMin: null,
		AnyaMagicMax: null,
		AnyaMagicLvl: 255,
		JamellaMin: 0,
		JamellaMax: 0,
		JamellaMagicMin: null,
		JamellaMagicMax: null,
		JamellaMagicLvl: 255,
		Transform: 0,
		InvTrans: 0,
		SkipName: 0,
		NightmareUpgrade: 'xxx',
		HellUpgrade: 'xxx',
		mindam: null,
		maxdam: null,
		PermStoreItem: 1,
		multibuy: 1,
		Nameable: null,
		diablocloneweight: null
	});
}
else {

	misc.rows = misc.rows.filter((row) => row.name !== 'Full Rejuvenation Potion')

	misc.rows.push({
		name: 'Full Rejuvenation Potion',
		compactsave: 1,
		version: 100,
		level: 0,
		ShowLevel: 0,
		levelreq: 0,
		reqstr: null,
		reqdex: null,
		rarity: 2,
		spawnable: 1,
		speed: 0,
		nodurability: 1,
		cost: config.sellPriceFull,
		'gamble cost': null,
		code: 'rvl',
		alternategfx: 'ypl',
		namestr: 'rvl',
		component: 16,
		invwidth: 1,
		invheight: 1,
		hasinv: 0,
		gemsockets: 0,
		gemapplytype: 0,
		flippyfile: 'flpvpl',
		invfile: 'invvpl',
		uniqueinvfile: null,
		Transmogrify: 0,
		TMogType: 'xxx',
		TMogMin: null,
		TMogMax: null,
		useable: 1,
		type: 'rpot',
		type2: null,
		dropsound: 'item_potion',
		dropsfxframe: 14,
		usesound: 'item_potion_drink',
		unique: 0,
		transparent: 0,
		transtbl: 5,
		lightradius: 0,
		belt: 1,
		autobelt: 1,
		stackable: 0,
		minstack: 0,
		maxstack: 0,
		spawnstack: 0,
		quest: null,
		questdiffcheck: null,
		missiletype: 0,
		spellicon: -1,
		pSpell: 5,
		state: null,
		cstate1: null,
		cstate2: null,
		len: null,
		stat1: 'hitpoints',
		calc1: 100,
		stat2: 'mana',
		calc2: 100,
		stat3: null,
		calc3: null,
		spelldesc: 4,
		spelldescstr: 'ItemStatsrejuv1',
		spelldescstr2: 0,
		spelldesccalc: 100,
		spelldesccolor: null,
		durwarning: 0,
		qntwarning: 0,
		gemoffset: 0,
		BetterGem: 'non',
		bitfield1: 0,
		CharsiMin: 1,
		CharsiMax: 1,
		CharsiMagicMin: null,
		CharsiMagicMax: null,
		CharsiMagicLvl: 255,
		GheedMin: 1,
		GheedMax: 1,
		GheedMagicMin: null,
		GheedMagicMax: null,
		GheedMagicLvl: 255,
		AkaraMin: 1,
		AkaraMax: 1,
		AkaraMagicMin: null,
		AkaraMagicMax: null,
		AkaraMagicLvl: 255,
		FaraMin: 1,
		FaraMax: 1,
		FaraMagicMin: null,
		FaraMagicMax: null,
		FaraMagicLvl: 255,
		LysanderMin: 1,
		LysanderMax: 1,
		LysanderMagicMin: null,
		LysanderMagicMax: null,
		LysanderMagicLvl: 255,
		DrognanMin: 1,
		DrognanMax: 1,
		DrognanMagicMin: null,
		DrognanMagicMax: null,
		DrognanMagicLvl: 255,
		HratliMin: 1,
		HratliMax: 1,
		HratliMagicMin: null,
		HratliMagicMax: null,
		HratliMagicLvl: 255,
		AlkorMin: 1,
		AlkorMax: 1,
		AlkorMagicMin: null,
		AlkorMagicMax: null,
		AlkorMagicLvl: 255,
		OrmusMin: 1,
		OrmusMax: 1,
		OrmusMagicMin: null,
		OrmusMagicMax: null,
		OrmusMagicLvl: 255,
		ElzixMin: 1,
		ElzixMax: 1,
		ElzixMagicMin: null,
		ElzixMagicMax: null,
		ElzixMagicLvl: 255,
		AshearaMin: 1,
		AshearaMax: 1,
		AshearaMagicMin: null,
		AshearaMagicMax: null,
		AshearaMagicLvl: 255,
		CainMin: 1,
		CainMax: 1,
		CainMagicMin: null,
		CainMagicMax: null,
		CainMagicLvl: 255,
		HalbuMin: 1,
		HalbuMax: 1,
		HalbuMagicMin: null,
		HalbuMagicMax: null,
		HalbuMagicLvl: 255,
		MalahMin: 1,
		MalahMax: 1,
		MalahMagicMin: null,
		MalahMagicMax: null,
		MalahMagicLvl: 255,
		LarzukMin: 1,
		LarzukMax: 1,
		LarzukMagicMin: null,
		LarzukMagicMax: null,
		LarzukMagicLvl: 255,
		AnyaMin: 1,
		AnyaMax: 1,
		AnyaMagicMin: null,
		AnyaMagicMax: null,
		AnyaMagicLvl: 255,
		JamellaMin: 1,
		JamellaMax: 1,
		JamellaMagicMin: null,
		JamellaMagicMax: null,
		JamellaMagicLvl: 255,
		Transform: 0,
		InvTrans: 0,
		SkipName: 0,
		NightmareUpgrade: 'xxx',
		HellUpgrade: 'xxx',
		mindam: null,
		maxdam: null,
		PermStoreItem: 1,
		multibuy: 1,
		Nameable: null,
		diablocloneweight: null
	});
}

D2RMM.writeTsv(miscFilename, misc);

const cubemainFilename = 'global\\excel\\cubemain.txt';
const cubemain = D2RMM.readTsv(cubemainFilename);

cubemain.rows.push({
	description: 'Convert Full Healing Potion to Full Rejuvenation Potion',
	enabled: 1,
	version: 100,
	numinputs: 1,
	'input 1': `hpot`,
	output: `useitem`,
	'output b': 'rvl',
	ilvl: 1000,
	'*eol': 0,
});

D2RMM.writeTsv(cubemainFilename, cubemain);


